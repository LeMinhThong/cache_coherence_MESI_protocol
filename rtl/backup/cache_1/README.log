process same as cache_0 but divided to several blocks (complex & useless & hard to read)
